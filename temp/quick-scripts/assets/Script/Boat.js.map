{"version":3,"sources":["Boat.js"],"names":["cc","Class","extends","Component","properties","passages","boatInfo","default","initSeats","seats","i","push","index","leftPos","x","Data","passagePositionLeft","y","rightPos","passagePositionRight","occupied","initBoatStatus","tigerNum","deerNum","atLeft","Math","abs","node","boatPositionLeft","hasDeer","length","animalType","searchSeat","isEmpty","validPassageCount","getOn","passage","onBoat","seatIndex","getOff","sail","delX","delY","sailAction","moveBy","v2","easing","easeCubicActionOut","onLoad","start"],"mappings":"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","file":"Boat.js","sourceRoot":"../../../../assets/Script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport Data from 'Data';\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    passages: [],  //  存放在船上的animal对象\n    boatInfo: {\n      default: null,\n    },\n  },\n\n  //  初始化座位\n  initSeats() {\n    this.seats = [];\n    for (let i = 0; i < 2; i++) {\n      this.seats.push({\n        index: i,\n        leftPos: {\n          x: Data.passagePositionLeft[i].x,\n          y: Data.passagePositionLeft[i].y,\n        },\n        rightPos: {\n          x: Data.passagePositionRight[i].x,\n          y: Data.passagePositionRight[i].y,\n        },\n        occupied: false,\n      });\n    }\n  },\n\n  //  初始化船上动物的数量信息\n  initBoatStatus() {\n    this.boatInfo = {\n      tigerNum: 0,\n      deerNum: 0,\n    };\n  },\n\n\n  //  判断是否在左岸\n  atLeft() {\n    if (Math.abs(this.node.x - Data.boatPositionLeft.x) < 10) return true;\n    return false;\n  },\n\n  //  判断船上是否有鹿\n  hasDeer() {\n    for (let i = 0; i < this.passages.length; i++) {\n      if (this.passages[i] && this.passages[i].animalType === 'deer') return true;\n    }\n    return false;\n  },\n  \n  //  寻找空座位，如果有座位返回座位index，如果没有返回null\n  searchSeat() {\n    for (let i = 0; i < this.seats.length; i++) {\n      if (!this.seats[i].occupied) return i;\n    }\n    return -1;\n  },\n\n  //  判断船是否为空\n  isEmpty() {\n    let validPassageCount = 0;\n    for (let i = 0; i < this.passages.length; i++) {\n      if (this.passages[i]) validPassageCount++;\n    }\n    if (validPassageCount < 1) return true;\n    return false;\n  },\n\n  //  上船\n  getOn(passage, index) {\n    // if (index !== -1) \n    this.seats[index].occupied = true;\n    this.passages[index] = passage;\n    passage.onBoat = true;\n    passage.seatIndex = index;\n  },\n\n  //  下船\n  getOff(passage, index) {\n    // console.log('index: ' + index);\n    this.seats[index].occupied = false;\n    this.passages[index] = null;\n    passage.onBoat = false;\n    passage.seatIndex = -1;\n  },\n\n  //  移动\n  sail({ delX, delY }) {\n    const sailAction = cc\n      .moveBy(3, cc.v2(delX, delY))\n      .easing(cc.easeCubicActionOut());\n\n    // const se = cc.sequence(sailAction, cc.callFunc(() => {\n    //   // console.log('finish');\n    // }, this));\n    // this.node.runAction(se);\n    // console.log('运动距离为:', delX, delY);\n    return sailAction;\n  },\n\n  onLoad () {\n    this.initSeats();  //  初始化座位对象\n    this.initBoatStatus();\n    // this.initBoatStatus();\n    // console.log(this.seats);\n  },\n\n  start() {\n\n  },\n\n  // update (dt) {},\n});\n"]}